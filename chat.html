<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Greenlet â€” Chat</title><link rel="stylesheet" href="style.css"><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script><script src="firebase.js"></script><script src="app.js"></script></head><body><script>renderSidebar()</script><div class="content"><div class="page-title">Chat</div><div class="panel" style="height:520px;overflow:auto" id="msgs"></div><div style="display:flex;gap:8px;margin-top:8px"><input id="msgIn" class="search" placeholder="Type a message..."/><button class="pill" onclick="sendMsg()">Send</button></div></div><script>requireAuth(async (user)=>{const me = await getOrCreateUser(user.uid);const msgs = document.getElementById('msgs');db.collection('chat').orderBy('ts').onSnapshot(snap=>{msgs.innerHTML='';snap.forEach(doc=>{const d=doc.data();const el=document.createElement('div');el.className='msg';el.innerHTML='<strong>'+ (d.username||'anon') +'</strong><div class="small">'+ (d.text) +'</div>';msgs.appendChild(el);});msgs.scrollTop=msgs.scrollHeight;});window.sendMsg=async()=>{const txt=document.getElementById('msgIn').value.trim();if(!txt) return;await db.collection('chat').add({uid:user.uid,username:me.username,text:txt,ts:firebase.firestore.FieldValue.serverTimestamp()});document.getElementById('msgIn').value='';}});</script></body></html>